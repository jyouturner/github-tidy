# Github Tidy

There are two main goals for this project:

1. have a utility to tidy up github repository branches by archiving and deleting old branches
2. more interestingly, test the solutions with two approaches:
    - use deepseek to generate plans, and use Claude to generate the code based on the plan
    - use Claude directly to generate the code

Note: in both cases, Cursor composer is used to finish the project and code from the Claude outputs.

## Branch Purging and Archival Policy

### 1. Branch Categorization

#### Protected Branches

- develop
- stage
- master
*(excluded from purging/archival)*

#### Feature/Hotfix/Release Branches

- All other branches *(subject to purging/archival)*

### 2. Criteria for Purging and Archival

- **Inactive Period:** No commits or updates in the last 30 days
- **Merged Status:** Branches already merged into develop, stage, or master

### 3. Archival Process

- **Archival Branch Prefix:** Move inactive branches to a prefixed namespace (e.g., `archived/branch-name`)
- **Tagging:** Optional tagging of latest commit before archiving (e.g., `archived-branchname-YYYYMMDD`)

### 4. Purging Process

- **Retention Period:** Keep archived branches for 60 days before permanent deletion
- **Auto-Deletion:** Automatically delete branches that remain archived and inactive for an additional 60 days

### 5. Exclusions

- Branches with active/open PRs
- Branches linked to critical releases or tagged versions

### Implementation Details

#### A. Automated Scripts

- Weekly execution of archival script
- Monthly execution of purge script

#### B. Notifications and Logging

- Slack/Email notifications before archival and deletion actions
- Action logging in centralized system for audit purposes

#### C. Governance and Approval Workflow

- Optional manual review for critical branches
- Approval process for branch deletion via Pull Requests

## Project generated by combining Deepseek and Claude

[Deepseek and Claude](./deepseek_and_claude)

## Project generated by Claude only

[Claude](./claude_only)

## Ask Gemini to Evaludate the two projects

First use the combine-files.sh to combine each project into one file.

Then asked Gemini-2.0-Flush-Exp to analyze the two projects and provide a recommendation on which approach is better.

[Prompt to Gemini 2.0 Flush](./per_gemini/prompt.txt)


[Gemini 2.0 Flush Analysis](./per_gemini/response.md)

Gemini-2.0-flush-exp thinks Claude-only is slightly better than the Deepseek-Claude project.

Obviously, our next question to Gemini is ... why don't you improve on the Claude-only project?

## Final Claude-Gemini Project

[Claude-Gemini](./claude_and_gemini)

Use Claude-only as the base, and ask Gemini to improve the project.

## Gemini-2.0-Flush-Exp's Final Analysis

Then we asked Gemini-2.0-Flush-Exp to analyze the final project by Claude-Gemini. Well, Gemini thinks this one is better, score 8.5/10. (after all, it is based on its suggestions, so bias is expected)

---

Okay, I've reviewed the final version of the `claude_and_gemini` project. It appears to be the result of combining the improvements from our previous discussion with the `claude_only` project and a pass through Gemini-2.0-flush.

**Evaluation:**

**Strengths:**

*   **Complete Feature Set:** This project now incorporates all the core requirements. It can:
    *   Identify inactive branches.
    *   Check merge status against protected branches.
    *   Check for open pull requests.
    *   Consider critical tags.
    *   Archive branches with a configurable prefix.
    *   Purge branches after a configurable retention period.
    *   Send notifications via Slack.
*   **Configurable:** Configuration is loaded via environment variables making it easily adaptable to different environments.
*   **Cloud Logging:** Uses Google Cloud Logging for centralized logging, which is very useful for production environments.
*   **Modular Design:** Keeps the separation of concerns with `branch_manager`, `config`, `logger`, and `notifier` classes.
*   **Error Handling:** Has comprehensive try-except blocks in API calls and logging errors.
*   **DRY Principle:** Eliminates code duplication by reusing helper methods.
*   **Clear Code:** Code is readable and easy to understand.

**Weaknesses:**

*   **Missing Tests:** Still lacking unit and integration tests.
*   **No Archival Tagging:** Does not have support for optional tagging of branches, which was a nice-to-have feature in the requirements.

**Code Quality Assessment:**

*   **Readability:** The code is clear, well-organized, and uses meaningful names.
*   **Maintainability:** The modular structure and clear logic make the code easy to maintain and extend.
*   **Error Handling:** Robust error handling is in place with proper logging.
*   **Completeness:** The project is functionally complete.

**Detailed Analysis:**

The project has significantly improved compared to the previous version. The addition of the missing branch checks (merged status, open PRs, and critical tags) and the implementation of the purging logic complete all of the core features. The use of environment variables makes it easy to deploy this application to different environments, and the google cloud logging is also very helpful in production environments. The separation of concerns, the modular design and the try-except blocks makes this project maintainable and robust.

The project now has most of the features except for the tests and archival tagging which is an optional feature.

**Scoring:**

Given the improvements and remaining weaknesses, I would score this project as follows:

*   **`claude_and_gemini` Score: 8.5 / 10**

**Recommendation:**

The `claude_and_gemini` project is now in a much better state, and ready to be deployed, the next step for this project is the inclusion of tests, and an improvement of the documentation, including a `README.md` with the instructions on how to configure the environment variables, and a comprehensive description of the project.

**Next Steps:**

1.  **Add Tests:** Create tests for all modules, to ensure the logic is correct, and avoid regressions in the future.
2.  **Archival Tagging:** Implement the optional tagging functionality if needed.
3.  **Documentation:** Update `README.md` with instructions on how to configure the project, and a comprehensive description of the project.
4.  **Review:** Do a final code review.

Overall, the `claude_and_gemini` project is a solid implementation of the branch management tool, which has significantly improved and now has all of the core features. The next step is the inclusion of tests and improved documentation.

